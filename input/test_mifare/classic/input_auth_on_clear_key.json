{
    "scripts": 
    [
        {
            "title": "test double card",
            "cards":
            [
                {
                    "cardID": 1,
                    "tokenType": "SMART_MX_WITH_MIFARE_1K",
                    "tokenID": "1234uniqueID",
                    "iso_4a":
                    {
                        "tokenID":"IsoSideTokenID",
                        "answerToSelect": "answertoselectbytes"

                    },
                    "mifare":
                    {
                        "cardID": 1,
                        "tokenType": "MIFARE_CLASSIC_1K",
                        "tokenID": "1234uniqueID",
                        "memorySectors":
                        [
                            {
                                "blocks":
                                [
                                    "block.00",
                                    "bl",
                                    "",
                                    "aaaaaax01xbbbbbb"
                                ]
                            },
                            {
                                "blocks":
                                [
                                    "block.10",
                                    5005,
                                    "block.12",
                                    "aaaaaax02xbbbbbb"
                                ]
                            },
                            {
                                "blocks":
                                [
                                    "block.20",
                                    "block.21",
                                    "block.22",
                                    "aaaaaax03xbbbbbb"
                                ]
                            }
                        ]
                    }
                }
            ],
            "steps":
            [
                {
                    "comment": "poll for token (timeout 1s), prefer mifare",
                    "message": "4952000B0103010A06100120023001E8BE",
                    "preactions":[{"attach_card": 1}]
                },
                {
                    "comment": "auth on clear key with correct key=aaaaaa, sector #1",
                    "message": "495200110105010A0C080010001A06616161616161D791"
                }
            ]
        },
        {
            "title": "test mifare classic auth on clearkey first try",
            "cards":
            [
                {
                    "cardID": 1,
                    "tokenType": "MIFARE_CLASSIC_1K",
                    "tokenID": "1234uniqueID",
                    "memorySectors":
                    [
                        {
                            "blocks":
                            [
                                "block.00",
                                "bl",
                                "",
                                "aaaaaax01xbbbbbb"
                            ]
                        },
                        {
                            "blocks":
                            [
                                "block.10",
                                5005,
                                "block.12",
                                "aaaaaax02xbbbbbb"
                            ]
                        },
                        {
                            "blocks":
                            [
                                "block.20",
                                "block.21",
                                "block.22",
                                "aaaaaax03xbbbbbb"
                            ]
                        }
                    ]
                }
            ],
            "steps":
            [
                {
                    "comment": "poll for token (timeout 1s)",
                    "message": "4952000B0103010A06100120023001E8BE",
                    "preactions":[{"attach_card": 1}]
                },
                {
                    "comment": "auth on clear key with correct key=aaaaaa, sector #1",
                    "message": "495200110105010A0C080010001A06616161616161D791"
                }
            ]
        },
        {
            "title": "test mifare classic auth on clearkey with retry",
            "cards":
            [
                {
                    "cardID": 1,
                    "tokenType": "MIFARE_CLASSIC_1K",
                    "tokenID": "1234uniqueID",
                    "memorySectors":
                    [
                        {
                            "blocks":
                            [
                                "block.00",
                                "bl",
                                "",
                                "aaaaaax01xbbbbbb"
                            ]
                        },
                        {
                            "blocks":
                            [
                                "block.10",
                                5005,
                                "block.12",
                                "aaaaaax02xbbbbbb"
                            ]
                        },
                        {
                            "blocks":
                            [
                                "block.20",
                                "block.21",
                                "block.22",
                                "aaaaaax03xbbbbbb"
                            ]
                        }
                    ]
                }
            ],
            "steps":
            [
                {
                    "comment": "poll for token (timeout 1s)",
                    "message": "4952000B0103010A06100120023001E8BE",
                    "preactions":[{"attach_card": 1}]
                },
                {
                    "comment": "auth on clear key command with wrong key (ffffff), then try right key (aaaaaa). The third message will be ignored",
                    "messages": [
                        "495200110105010A0C080010001A0666666666666645C9",
                        "495200110105010A0C080010001A06616161616161D791",
                        "495200110105010A0C080010001A0666666666666645C9"
                    ]
                }
            ]
        }
    ]
}